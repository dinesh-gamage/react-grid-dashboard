<!DOCTYPE html>
<html>

<head>
    <link rel="icon" href="https://static.iviva.com/favicon.ico" type="image/x-icon">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">

    <link rel="stylesheet" href="./node_modules/react-grid-layout/css/styles.css">
    <link rel="stylesheet" href="./node_modules/react-resizable/css/styles.css">

    <title>React Grid</title>
</head>

<body>
    <div id="root"></div>

    <!-- Dependencies -->
    <script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>

    <script crossorigin src="https://unpkg.com/prop-types/prop-types.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/recharts/1.8.5/Recharts.min.js"></script>

    <!-- Main -->

    <script>

        let scripts = [
            "./resources/widgets/widget-set-01/main.js",
        ]

        window.Widgets = [];

        // register widgets
        function registerWidget(widgetConfig) {
            console.log("registering widget");
            console.log(widgetConfig);
            window.Widgets.push(widgetConfig);
        }


        // load scripts functions
        const loadWidgets = (widgets, callback) => {

            widgets.map((widget, i) => {
                console.log(widget);
                loadScriptFile(widget);
            })

            if (typeof callback == "function") {
                callback();
            }
        }

        const loadScriptFile = (path, callback) => {
            var script = document.createElement('script');

            if (script.readyState) {  // only required for IE <9
                script.onreadystatechange = function () {
                    if (script.readyState === "loaded" || script.readyState === "complete") {
                        script.onreadystatechange = null;

                        if (typeof callback == "function") {
                            callback();
                        }
                    }
                };
            } else {  //Others
                script.onload = function () {
                    if (typeof callback == "function") {
                        callback();
                    }
                };
            }

            script.setAttribute('src', path);
            document.body.appendChild(script);
        }

        // load widget scripts
        loadWidgets(scripts, loadScriptFile.bind(this, "./dist/main.js", () => {
            renderDashboard("root");
        }))

    </script>


</body>

</html>